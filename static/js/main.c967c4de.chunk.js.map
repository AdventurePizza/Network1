{"version":3,"sources":["firebaseContext.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["FirebaseContext","React","createContext","getProfileFB","Promise","resolve","isSuccessful","setProfileFB","getAllProfilesFB","fetchBase","FirebaseProvider","children","useCallback","key","a","fetch","method","fetchRes","ok","json","profile","headers","body","JSON","stringify","message","statusText","Provider","value","socketURL","window","location","hostname","socket","io","transports","dAppClient","DAppClient","name","tempID","uuidv4","App","useState","activeAccount","setActiveAccount","synced","setSynced","showUnsync","setShowUnsync","color","setColor","useContext","timestamp","Date","now","username","setProfile","profiles","setProfiles","getDomain","address","query","variables","then","res","result","data","reverseRecord","domain","getActiveAccount","clearActiveAccount","sync","console","log","requestPermissions","permissions","useEffect","getProfiles","onProfileChange","find","prof","index","slice","on","off","getAcc","className","style","fontSize","display","alignItems","margin","width","marginLeft","marginRight","overflowX","textAlign","height","backgroundColor","border","map","onChange","Button","size","title","onClick","emit","position","unsync","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.c967c4de.chunk.js","sourcesContent":["// @ts-nocheck\nimport React, { useCallback } from 'react';\n\ninterface IProfile {\n\tcolor: string,\n\ttimestamp: Date,\n\tkey: string,\n\tusername: string\n}\nexport interface IFirebaseContext {\n\n\tgetProfileFB: (key: string) => Promise<IFetchResponseBase>;\n\tsetProfileFB: (\n\t\tprofile: IProfile\n\t) => Promise<IFetchResponseBase>;\n\n\tgetAllProfilesFB: () => Promise<IFetchResponseBase>;\n}\n\nexport const FirebaseContext = React.createContext<IFirebaseContext>({\n\tgetProfileFB: () => Promise.resolve({ isSuccessful: false }),\n\tsetProfileFB: () => Promise.resolve({ isSuccessful: false }),\n\tgetAllProfilesFB: () => Promise.resolve({ isSuccessful: false }),\n});\n\nconst fetchBase =\n\tprocess.env.NODE_ENV === 'development'\n\t\t? ''\n\t\t: 'https://network1-backend.herokuapp.com';\n\n\nexport const FirebaseProvider: React.FC = ({ children }) => {\n\n\n\tconst getProfileFB = useCallback(\n\t\tasync (key: string): Promise<IFetchResponseBase> => {\n\t\t\tconst fetchRes = await fetch(fetchBase + `/users/profile/${key}`, {\n\t\t\t\tmethod: 'GET'\n\t\t\t});\n\n\t\t\tif (fetchRes.ok) {\n\t\t\t\treturn await fetchRes.json();\n\t\t\t}\n\t\t},\n\t\t[]\n\t);\n\n\tconst setProfileFB = useCallback(\n\t\tasync (profile: IProfile): Promise<IFetchResponseBase> => {\n\t\t\tconst fetchRes = await fetch(fetchBase + `/users/profile`, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify({ profile: profile })\n\t\t\t});\n\n\t\t\tif (fetchRes.ok) {\n\t\t\t\treturn { isSuccessful: true };\n\t\t\t}\n\n\t\t\treturn { isSuccessful: false, message: fetchRes.statusText };\n\t\t},\n\t\t[]\n\t);\n\n\tconst getAllProfilesFB = useCallback(\n\t\tasync (): Promise<IFetchResponseBase> => {\n\t\t\tconst fetchRes = await fetch(fetchBase + `/users/allProfiles`, {\n\t\t\t\tmethod: 'GET'\n\t\t\t});\n\n\t\t\tif (fetchRes.ok) {\n\n\t\t\t\treturn await fetchRes.json();\n\t\t\t}\n\t\t},\n\t\t[]\n\t);\n\n\treturn (\n\t\t<FirebaseContext.Provider\n\t\t\tvalue={{\n\t\t\t\tgetProfileFB,\n\t\t\t\tsetProfileFB,\n\t\t\t\tgetAllProfilesFB\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</FirebaseContext.Provider>\n\t);\n};\n","// @ts-nocheck\n\nimport \"./App.css\";\nimport React, {\n  useEffect,\n  useState,\n  useContext\n} from \"react\";\n\n//ui\nimport { Button, TextField } from \"@material-ui/core\";\n\n//logic\nimport io from \"socket.io-client\";\nimport { DAppClient } from \"@airgap/beacon-sdk\";\n//import _ from \"underscore\";\nimport { HexColorPicker } from \"react-colorful\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { FirebaseContext } from \"./firebaseContext\";\n\nconst socketURL =\n  window.location.hostname === \"localhost\"\n    ? \"ws://localhost:8000\"\n    : \"wss://network1-backend.herokuapp.com\";\n\n\nconst socket = io(socketURL, { transports: [\"websocket\"] });\nconst dAppClient = new DAppClient({ name: \"Beacon Docs\" });\n\nconst tempID = uuidv4();\nfunction App() {\n\n  const [activeAccount, setActiveAccount] = useState();\n  const [synced, setSynced] = useState('sync');\n  const [showUnsync, setShowUnsync] = useState(false);\n  const [color, setColor] = useState(\"#000000\");\n  const { getProfileFB, setProfileFB, getAllProfilesFB } = useContext(FirebaseContext);\n  const [profile, setProfile] = useState({ color: color, timestamp: Date.now(), key: tempID, username: \"anon\" });\n  const [profiles, setProfiles] = useState(\n    [\n      { color: \"blue\", timestamp: Date.now(), key: tempID, username: \"user x\" },\n    ]);\n\n\n  useEffect(() => {\n\n    async function getProfiles() {\n      setProfiles(await getAllProfilesFB())\n    }\n    getProfiles();\n\n  }, []);\n\n\n  useEffect(() => {\n\n    const onProfileChange = (data) => {\n      console.log(data)\n      console.log(data.key)\n      profiles.find(function (prof, index) {\n        if (prof.key === data.key) {\n          console.log(\"found ez ! \" + index)\n          setProfiles([\n            ...profiles.slice(0, index),\n            data,\n            ...profiles.slice(index + 1)\n          ]\n          )\n          return true;\n        }\n        return false;\n      });\n    };\n\n\n    socket.on('profile', onProfileChange);\n\n    return () => {\n      socket.off('profile', onProfileChange);\n\n\n    };\n  }, [profiles, setProfiles]);\n\n\n  //fetch wallet name if it exist for example, trydrum.tez\n  async function getDomain(address: string) {\n    let domain;\n    await fetch('https://api.tezos.domains/graphql', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        query: `\n            {\n              reverseRecord(address: \"`+ address + `\"){owner domain{name}}\n            }\n            `,\n        variables: {\n        },\n      }\n      ),\n    })\n      .then((res) => res.json())\n      .then((result) => {\n        if (result.data.reverseRecord) {\n          domain = result.data.reverseRecord.domain.name;\n          setSynced(domain);\n          setProfile({ ...profile, username: domain })\n        }\n      });\n  }\n\n  useEffect(() => {\n    async function getAcc() {\n      setActiveAccount(await dAppClient.getActiveAccount());\n      if (activeAccount) {\n        setSynced(activeAccount.address.slice(0, 6) + \"...\" + activeAccount.address.slice(32, 36));\n        setShowUnsync(true);\n        getDomain(activeAccount.address);\n        setProfile(await getProfileFB(activeAccount.address));\n      }\n      else {\n        setSynced('sync');\n        setShowUnsync(false);\n      }\n    }\n    getAcc();\n\n  }, [activeAccount]);\n\n\n\n  async function unsync() {\n    setActiveAccount(await dAppClient.getActiveAccount())\n    if (activeAccount) {\n      // User already has account connected, everything is ready\n      dAppClient.clearActiveAccount().then(async () => {\n        setActiveAccount(await dAppClient.getActiveAccount())\n        setSynced('sync');\n        setShowUnsync(false);\n      });\n    }\n  }\n\n  async function sync() {\n    setActiveAccount(await dAppClient.getActiveAccount())\n    //Already connected\n    if (activeAccount) {\n      setSynced(activeAccount.address)\n      setShowUnsync(true);\n      getDomain(activeAccount.address);\n\n      return activeAccount;\n    }\n    // The user is not synced yet\n    else {\n      try {\n        console.log(\"Requesting permissions...\");\n        const permissions = await dAppClient.requestPermissions();\n        setActiveAccount(await dAppClient.getActiveAccount())\n        console.log(\"Got permissions:\", permissions.address);\n        setSynced(permissions.address)\n        setShowUnsync(true);\n\n        getDomain(permissions.address);\n\n      }\n      catch (error) {\n        console.log(\"Got error:\", error);\n      }\n    }\n  }\n\n\n\n  return (\n    <div >\n      <div className=\"top-left\" style={{ fontSize: \"1em\", display: \"flex\", alignItems: \"center\", margin: 10 }} >\n        <b>Network1</b>\n      </div>\n\n      <div style={{ display: \"flex\", width: \"90%\", marginLeft: \"auto\", marginRight: \"auto\", overflowX: \"scroll\" }} >\n\n        <div style={{ textAlign: \"center\", margin: 6 }}>\n          <div style={{ width: 100, height: 50, backgroundColor: profile.color, border: \"solid 4px \", margin: 4 }}>\n          </div>\n          {profile.username}\n        </div>\n\n        {profiles && profiles.map((profile) => (\n          (!activeAccount || profile.key !== activeAccount.address) &&\n          <div key={profile.key} style={{ textAlign: \"center\", margin: 6 }}>\n            <div style={{ width: 100, height: 50, backgroundColor: profile.color, border: \"solid 4px \", margin: 4 }}>\n            </div>\n            {profile.username}\n          </div>\n        ))\n        }\n\n      </div>\n\n      <div style={{ width: \"90%\", marginLeft: \"auto\", marginRight: \"auto\" }} >\n        <HexColorPicker color={color} onChange={setColor} />\n        <br></br>\n        <Button size={\"small\"} title={\"update status\"} onClick={() => {\n          if (activeAccount) {\n            setProfile({ ...profile, color: color, key: activeAccount.address })\n            //add socket \n            socket.emit('profile', { ...profile, color: color, key: activeAccount.address });\n            setProfileFB({ ...profile, color: color, key: activeAccount.address });\n          }\n\n        }} >  {activeAccount ? <u>update status</u> : <u>sync to join network1</u>} </Button>\n\n      </div>\n\n      <div className=\"bottom-right\" style={{ position: \"absolute\", display: \"flex\" }} >\n        {showUnsync && <Button size={\"small\"} title={\"unsync\"} onClick={() => { unsync() }} ><u>unsync</u> </Button>}\n\n        {showUnsync && <div> | </div>}\n        <Button title={\"sync\"} size={\"small\"} onClick={async () => { await sync(); }} ><u>{synced}</u> </Button>\n\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);  \n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n}\n\nexport default reportWebVitals;\n","import \"./index.css\";\n\nimport App from \"./App\";\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { FirebaseProvider } from \"./firebaseContext\";\n\nReactDOM.render(\n  <FirebaseProvider>\n    <App />\n  </FirebaseProvider>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}